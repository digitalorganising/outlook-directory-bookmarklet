# outlook-directory-bookmarklet

A bookmarklet to get the contents of your Outlook directory into a CSV.

### Usage

1. Drag this link to your bookmark bar: **[Get Outlook Directory][bookmarklet-ref]**.
2. Go to <https://outlook.office.com/>.
3. Click the bookmark you created in step 1.

[bookmarklet-ref]:javascript:void%2520function%28%29%7Basync%2520function%2520a%28%29%7Bconst%2520a%3Dawait%2520cookieStore.get%28%2522X-OWA-CANARY%2522%29%3Bconsole.log%28%2522Requesting%2520an%2520access%2520token%2520for%2520Graph...%2522%29%3Bconst%2520b%3Dawait%2520fetch%28%2522https%3A%2F%2Foutlook.office.com%2Fowa%2Fservice.svc%253Faction%3DGetAccessTokenforResource%2522%2C%7Bheaders%3A%7Baction%3A%2522GetAccessTokenforResource%2522%2C%2522content-type%2522%3A%2522application%2Fjson%3B%2520charset%3Dutf-8%2522%2C%2522x-owa-canary%2522%3Aa.value%2C%2522x-owa-urlpostdata%2522%3AencodeURIComponent%28JSON.stringify%28%7B__type%3A%2522TokenRequest%3A%2523Exchange%2522%2CResource%3A%2522https%3A%2F%2Fgraph.microsoft.com%2F%2522%7D%29%29%2C%2522x-req-source%2522%3A%2522Mail%2522%7D%2Cmethod%3A%2522POST%2522%2Cmode%3A%2522cors%2522%2Ccredentials%3A%2522include%2522%7D%29%2C%7BAccessToken%3Ac%2CAccessTokenExpiry%3Ad%7D%3Dawait%2520b.json%28%29%3Breturn%2520console.log%28%60%2525cSuccessfully%2520retrieved%2520token%2520%2525c%28expires%3A%2520%24%7Bd%7D%29%60%2C%2522color%3A%2520green%2522%2C%2522color%3A%2520gray%3B%2520font-style%3A%2520italic%2522%29%2Cc%7Dasync%2520function*b%28a%2Cc%3D0%29%7Bconst%2520d%3Dnew%2520URLSearchParams%28%7B%24top%3A200%2C%24skip%3Ac%2C%24orderBy%3A%2522displayName%2522%2C%24filter%3A%2522personType%2Fsubclass%2520eq%2520'OrganizationUser'%2522%7D%29%2Ce%3Dawait%2520fetch%28%2522https%3A%2F%2Fgraph.microsoft.com%2Fv1.0%2Fme%2Fpeople%253F%2522%2Bd.toString%28%29%2C%7Bheaders%3A%7Bauthorization%3A%60Bearer%2520%24%7Ba%7D%60%2C%2522content-type%2522%3A%2522application%2Fjson%2522%2C%2522X-PeopleQuery-QuerySources%2522%3A%2522Mailbox%2CDirectory%2522%7D%2Cmethod%3A%2522GET%2522%2Ccredentials%3A%2522omit%2522%7D%29%2Cf%3Dawait%2520e.json%28%29%2Cg%3Df.value%3Bconsole.log%28%60%2525cFetched%2520%2525c%24%7Bg.length%7D%2525c%2520people%2C%2520skipped%2520%24%7Bc%7D%60%2C%2522color%3A%2520green%2522%2C%2522font-weight%3A%2520bold%2522%2C%2522font-weight%3A%2520normal%2522%29%2Cyield*g%2Cf%5B%2522%2540odata.nextLink%2522%5D%2526%2526%28yield*b%28a%2Cc%2Bg.length%29%29%7Dconst%2520c%3Da%3D%253E!a.surname%7C%7C!a.givenName%2Cd%3Da%3D%253E%28%7Bemail%3Aa.scoredEmailAddresses%5B0%5D.address%2Cname%3Aa.givenName%2Cdepartment%3Aa.department%2CjobTitle%3Aa.jobTitle%7D%29%2Ce%3Da%3D%253EObject.values%28a%29.map%28a%3D%253E%2522string%2522%3D%3Dtypeof%2520a%253FJSON.stringify%28a%29%3Aa%29.toString%28%29%2B%2522%5Cn%2522%3B%28async%2520function%28%29%7Bconst%2520f%3Dawait%2520window.showSaveFilePicker%28%7BsuggestedName%3A%2522organisation-directory.csv%2522%2Ctypes%3A%5B%7Bdescription%3A%2522CSV%2520%28Comma-separated%2520values%29%2522%2Caccept%3A%7B%2522text%2Fcsv%2522%3A%5B%2522.csv%2522%5D%7D%7D%5D%7D%29%2Cg%3Dawait%2520f.createWritable%28%29%2Ch%3Dawait%2520a%28%29%3Blet%2520i%3D0%3Bfor%2520await%28const%2520a%2520of%2520b%28h%29%29%7Bconst%2520b%3Dd%28a%29%3Bif%28c%28a%29%29%7Bconsole.log%28%60%2525cSkipping%2520%24%7Bb.email%7D%60%2C%2522color%3A%2520gray%3B%2520font-style%3A%2520italic%3B%2520font-size%3A%25200.5rem%2522%29%3Bcontinue%7D0%3D%3D%3Di%2526%2526%28await%2520g.write%28Object.keys%28b%29.toString%28%29%2B%2522%5Cn%2522%29%29%2Cawait%2520g.write%28e%28b%29%29%2Ci%2B%3D1%7Dawait%2520g.close%28%29%2Cconsole.log%28%60%2525cWrote%2520%24%7Bi%7D%2520people%2520to%2520%24%7Bf.name%7D%60%2C%2522color%3A%2520green%3B%2520font-weight%3A%2520bold%2522%29%7D%29%28%29%7D%28%29%3B
